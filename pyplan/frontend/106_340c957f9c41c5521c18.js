/*! Copyright Novix S.A. 2019. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{688:function(n,t,i){"use strict";var a=i(18);n.exports=function(n){return(0,a.translate)(n)}},693:function(n,t,i){"use strict";i.r(t),function(n){i.d(t,"ajaxSetup",function(){return e}),i.d(t,"send",function(){return o});var a=i(18);function e(t=null){n.ajaxSetup({...{dataType:"json",crossDomain:!0,headers:{Authorization:`Token ${__currentToken}`,"session-key":__currentSession?__currentSession.session_key:""}},...()=>t||{}})}function o(t,e,o,s,r,c,l){o||(o=new Object),c||n("#secondLoading").show(),o.hasOwnProperty("success")||(o.success=function(t,a,e){if("object"!=typeof t&&null!=t&&""!=t)try{t=n.parseJSON(t)}catch(n){}c||(n("#mainLoading").hide(),n("#secondLoading").hide());var o=function(n,t,a,e,o){n&&n.hasOwnProperty("hasError")?(a||Promise.all([i.e(2),i.e(18)]).then(function(){var t=[i(685)];(function(t){(new t).show({title:"WARNING!",text:n.error,notifyType:"error"})}).apply(null,t)}).catch(i.oe),void 0!=o&&o(n.error)):void 0!=e&&e(n,t)};t&&t.hasOwnProperty("isCompressed")&&t.hasOwnProperty("obj")?i.e(105).then(function(){var a=[i(856)];(function(i){t=n.parseJSON(i.inflate(atob(t.obj),{to:"string"})),o(t,e,l,s,r)}).apply(null,a)}).catch(i.oe):o(t,e,l,s,r)}),o.hasOwnProperty("type")||(o.type="GET"),e&&(o.data=e),o.error=function(e,s,u){if(c||(n("#mainLoading").hide(),n("#secondLoading").hide()),e){let n="";const s=`[${o.type}] ${t}`;if(e.responseJSON)for(const t in e.responseJSON)n+="non_field_errors"==t?`${e.responseJSON[t]}\n`:`[${t}]: ${e.responseJSON[t]}\n`;else n=`${e.responseText}\n`;let c="info",u=void 0,f=void 0,d="WARNING!";const p=[];switch(e.status){case 401:c="info",f=15e3,u=(()=>{location.reload()}),p.push({css:"warning",code:"401",title:Object(a.translate)("relog")});break;case 403:c="info",f=1e4,d=Object(a.translate)("access_denied")}void 0!=l&&0!=l||Promise.all([i.e(2),i.e(18)]).then(function(){var t=[i(685)];(function(t){(new t).show({title:d,text:n,endpoint:s,notifyType:c,timeOut:f,buttons:p,callback:u})}).apply(null,t)}).catch(i.oe),void 0!=r&&r(n,e)}},n.ajax({url:`${__apiURL}/${t}`,contentType:o.contentType,data:e,dataType:o.dataType?o.dataType:"json",method:o.type,success:o.success,error:o.error})}}.call(this,i(1))},719:function(n,t,i){"use strict";n.exports=function(){return __apiURL}},799:function(n,t,i){"use strict";var a=i(18);n.exports=function(n){return(0,a.timeAgo)(n)}},855:function(n,t,i){"use strict";(function(a,e){var o,s=i(693);void 0===(o=function(){var n;return a.Model.extend({start:function(){n=setTimeout(function t(){(0,s.send)("notification/KeepAlive",null,null,function(i){if(i){var a=i.unread;e("#navigation .unreadNotifications").length>0&&(e("#navigation .unreadNotifications").text(a).hide(),a>0&&e("#navigation .unreadNotifications").show())}n=setTimeout(t,4e4)},void 0,!0)},1e3)},stop:function(){clearTimeout(n)},getNotifications:function(n){(0,s.send)("notification/getNotifications",null,null,n)},markAsRead:function(n,t){(0,s.send)("notification/markAsRead?id="+n,null,null,t)}})}.apply(t,[]))||(n.exports=o)}).call(this,i(218),i(1))},882:function(n,t,i){"use strict";(function(a,e){var o,s,r=i(18);o=[i(855),i(985)],void 0===(s=function(n,t){return a.Controller.extend({name:"notificationManager",start:function(){var i=new n;i.start(),e("#navigation .btnNotification").on("click",function(){e("#navigation .notificationsList").empty(),e("#navigation .notificationsList").append("<li><a><div class='message'>"+(0,r.translate)("loading_notifications")+"</div></a></li>"),i.getNotifications(function(n){if(e("#navigation .notificationsList").empty(),n&&0!=n.length){var i=t(n);e("#navigation .notificationsList").append(i)}else e("#navigation .notificationsList").append("<li><a><div class='message'>"+(0,r.translate)("no_new_notifications")+"</div></a></li>")})}),e("#navigation .notificationsList").on("click","li a, li a .btnMarkAsRead",function(n){if(e(this).closest("li").hasClass("notificationItem")&&!e(this).closest("li.notificationItem").find("a").hasClass("read")){var t=e(this).closest("li").attr("data-id");i.markAsRead(t),e(this).closest("li").find("a").addClass("read");var a=parseInt(e("#navigation .unreadNotifications").text())-1;e("#navigation .unreadNotifications").text(a).show(),a<=0&&e("#navigation .unreadNotifications").hide()}if(e(this).hasClass("btnMarkAsRead"))return!1})},notify:function(n){(0,r.showMessage)(n.textMessage,(0,r.translate)("new_notification"),"info"),e("#navigation .unreadNotifications").text(parseInt(e("#navigation .unreadNotifications").text())+1).show()}})}.apply(t,o))||(n.exports=s)}).call(this,i(694),i(1))},985:function(n,t,i){var a=i(690);function e(n){return n&&(n.__esModule?n.default:n)}n.exports=(a.default||a).template({1:function(n,t,a,o,s){var r,c=n.lambda,l=n.escapeExpression,u=null!=t?t:n.nullContext||{};return'<li class="notificationItem" data-id="'+l(c(null!=t?t.notificationId:t,t))+'" data-messageType="'+l(c(null!=t?t.messageType:t,t))+'">\n    <a href="#" '+(null!=(r=a.if.call(u,null!=t?t.read:t,{name:"if",hash:{},fn:n.program(2,s,0),inverse:n.noop,data:s}))?r:"")+'>\n        \x3c!--img src="'+l(e(i(719)).call(u,{name:"baseURL",hash:{},data:s}))+"thumbs/view.ashx?img=users-"+l(c(null!=t?t.fromUserImageUrl:t,t))+'&w=43&h=43&t=cropt" alt="'+l(c(null!=t?t.fromUser:t,t))+'" title="'+l(c(null!=t?t.fromUser:t,t))+'" /--\x3e\n        <div class="details">\n            <div class="message">\n                <p>'+(null!=(r=c(null!=t?t.textMessage:t,t))?r:"")+'</p>\n                <span class="time">'+l(e(i(799)).call(u,null!=t?t.createdDate:t,{name:"timeAgo",hash:{},data:s}))+'</span>\n            </div>\n        </div>\n        <i class="far fa-circle btnMarkAsRead" title="'+l(e(i(688)).call(u,"mark_as_read",{name:"L",hash:{},data:s}))+'"></i>\n    </a>\n</li>\n'},2:function(n,t,i,a,e){return' class="read" '},compiler:[7,">= 4.0.0"],main:function(n,t,i,a,e){var o;return null!=(o=i.each.call(null!=t?t:n.nullContext||{},t,{name:"each",hash:{},fn:n.program(1,e,0),inverse:n.noop,data:e}))?o:""},useData:!0})}}]);