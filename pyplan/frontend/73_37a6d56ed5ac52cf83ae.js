/*! Copyright Novix S.A. 2019. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[73,277],{1336:function(n,t,a){"use strict";(function(e,i){var o,l,s=a(18);o=[a(746),a(710),a(725),a(1975)],void 0===(l=function(n,t,o,l){return e.View.extend({el:i("#main"),_uId:"",render:function(){i("#mainLoading").show(),i("div[data-rel='abm-group']").remove();var e,d,u=new n,c=this;this._uId=i.uuid(),e=this.options.groupId?new Promise(function(n,t){u.get(c.options.groupId,function(t){var a={id:c._uId,dataRel:"abm-group",tmpClass:"group-edit",title:(0,s.translate)("_editGroup")},e={group:t,isSuper:__currentSession.userIsSuperUser};n({dataBaseTemplate:a,dataUniqTemplate:e})})}):new Promise(function(n,t){n({dataBaseTemplate:{id:c._uId,dataRel:"abm-group",tmpClass:"group-create",title:(0,s.translate)("_newGroup")},dataUniqTemplate:{isSuper:__currentSession.userIsSuperUser}})}),d=new Promise(function(n,t){a.e(24).then(function(){var t=[a(726)];(function(t){(new t).list(function(t){n(t)})}).apply(null,t)}).catch(a.oe)}),Promise.all([e,d]).then(function(n){var a=n[1],e=n[0].dataBaseTemplate,d=n[0].dataUniqTemplate;d.companies=a.results;var u=t(e),r=o(),p=l(d);c.$el.append(u),i("div[data-id='"+c._uId+"']").find("div.abm-content").append(r),i("div[data-id='"+c._uId+"']").find("div.form-content").append(p),i("div[data-id='"+c._uId+"']").find("div.group-code input").removeAttr("disabled");i("div[data-id='"+c._uId+"'] div.company-id select");(0,s.postRender)(c.$el.find("div[data-id='"+c._uId+"']")),c.addHandlers(),i("#mainLoading").hide()})},save:function(){var t=this._uId,e=i("div[data-id='"+t+"']").find("form");if(!i(e).validate().errorList.length>0){var o=i("div[data-id='"+t+"']").find("div.group-name input").val(),l=i("div[data-id='"+t+"']").find("div.company-id select").val(),s=new n,d={name:o};__currentSession.userIsSuperUser&&(d.company_id=l),this.options.groupId?s.update(this.options.groupId,d,function(){Promise.resolve().then(function(){var n=[a(762)];(function(n){(new n).show()}).apply(null,n)}).catch(a.oe)}):s.create(d,function(){Promise.resolve().then(function(){var n=[a(762)];(function(n){(new n).show()}).apply(null,n)}).catch(a.oe)})}},cancel:function(){Promise.resolve().then(function(){var n=[a(762)];(function(n){(new n).show()}).apply(null,n)}).catch(a.oe)},addHandlers:function(){i("div[data-id='"+this._uId+"']").find("form").on("submit",i.proxy(function(){return this.save(),!1},this)),i("div[data-id='"+this._uId+"']").find("div.submit button.btn-cancel").on("click",i.proxy(function(){return this.cancel(),!1},this)),i("div[data-id='"+this._uId+"']").find("div.abm-top-options a.btn-close").on("click",this.cancel)}})}.apply(t,o))||(n.exports=l)}).call(this,a(218),a(1))},1975:function(n,t,a){var e=a(690);function i(n){return n&&(n.__esModule?n.default:n)}n.exports=(e.default||e).template({1:function(n,t,e,o,l,s,d){var u,c=null!=t?t:n.nullContext||{};return'<div class="form-group">\n    <label for="textfield" class="col-sm-2 control-label">'+n.escapeExpression(i(a(688)).call(c,"_company",{name:"L",hash:{},data:l}))+'</label>\n    <div class="col-sm-10">\n        <div class="col-sm-4 company-id">\n            <select class="form-control" data-rule-required="true">\n'+(null!=(u=e.each.call(c,null!=t?t.companies:t,{name:"each",hash:{},fn:n.program(2,l,0,s,d),inverse:n.noop,data:l}))?u:"")+"            </select>\n        </div>\n    </div>\n</div>\n"},2:function(n,t,e,o,l,s,d){var u,c=n.lambda,r=n.escapeExpression;return'                <option value="'+r(c(null!=t?t.id:t,t))+'" '+(null!=(u=i(a(689)).call(null!=t?t:n.nullContext||{},null!=t?t.id:t,"==",null!=(u=null!=d[1]?d[1].group:d[1])?u.company:u,{name:"ifCond",hash:{},fn:n.program(3,l,0,s,d),inverse:n.noop,data:l}))?u:"")+">"+r(c(null!=t?t.name:t,t))+"</option>\n"},3:function(n,t,a,e,i){return" selected "},compiler:[7,">= 4.0.0"],main:function(n,t,e,o,l,s,d){var u,c=null!=t?t:n.nullContext||{},r=n.escapeExpression;return(null!=(u=e.if.call(c,null!=t?t.isSuper:t,{name:"if",hash:{},fn:n.program(1,l,0,s,d),inverse:n.noop,data:l}))?u:"")+'<div class="form-group">\n    <label for="textfield" class="col-sm-2 control-label">'+r(i(a(688)).call(c,"_name",{name:"L",hash:{},data:l}))+'</label>\n    <div class="col-sm-10">\n        <div class="col-sm-5 group-name">\n            <input type="text" value="'+r(n.lambda(null!=(u=null!=t?t.group:t)?u.name:u,t))+'" class="form-control" name="groupname" data-rule-required="true"\n                data-rule-minlength="3">\n        </div>\n    </div>\n</div>'},useData:!0,useDepths:!0})},710:function(n,t,a){var e=a(690);n.exports=(e.default||e).template({compiler:[7,">= 4.0.0"],main:function(n,t,a,e,i){var o,l=null!=t?t:n.nullContext||{},s=a.helperMissing,d=n.escapeExpression;return'<div class="abm-base-tmp '+d("function"==typeof(o=null!=(o=a.tmpClass||(null!=t?t.tmpClass:t))?o:s)?o.call(l,{name:"tmpClass",hash:{},data:i}):o)+' container-fluid mainTask" data-id="'+d("function"==typeof(o=null!=(o=a.id||(null!=t?t.id:t))?o:s)?o.call(l,{name:"id",hash:{},data:i}):o)+'" data-rel="'+d("function"==typeof(o=null!=(o=a.dataRel||(null!=t?t.dataRel:t))?o:s)?o.call(l,{name:"dataRel",hash:{},data:i}):o)+'" data-type="tab-content">\n    <div class="row">\n        <div class="col-sm-12">\n            <div class="box">\n                <div class="box-title">\n                    <h3><i class="fa fa-th-list"></i>'+d("function"==typeof(o=null!=(o=a.title||(null!=t?t.title:t))?o:s)?o.call(l,{name:"title",hash:{},data:i}):o)+'</h3>\n                    <div class="actions abm-top-options">\n                        <a href="#" class="btn btn-close"><i class="fa fa-times"></i></a>\n                    </div>\n                </div>\n        <div class="box-content nopadding abm-content">\n\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'},useData:!0})},725:function(n,t,a){var e=a(690);function i(n){return n&&(n.__esModule?n.default:n)}n.exports=(e.default||e).template({compiler:[7,">= 4.0.0"],main:function(n,t,e,o,l){var s=null!=t?t:n.nullContext||{},d=n.escapeExpression;return'<form action="#" id="baseForm" method="POST" class=\'form-horizontal form-bordered form-validate\' novalidate="novalidate">\n    <div class="form-content">\n\n    </div>\n    <div class="submit form-actions col-sm-12">\n        <button type="submit" class="btn btn-primary btn-save">'+d(i(a(688)).call(s,"_save",{name:"L",hash:{},data:l}))+'</button>\n        <button type="button" class="btn btn-cancel">'+d(i(a(688)).call(s,"cancel",{name:"L",hash:{},data:l}))+"</button>\n    </div>\n</form>\n"},useData:!0})},746:function(n,t,a){"use strict";(function(e){var i,o=a(693);void 0===(i=function(){return e.Model.extend({list:function(n,t){var a=null!=n?"?company_id=".concat(n):"";(0,o.send)("groups/".concat(a),null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},t)},get:function(n,t){(0,o.send)("groups/".concat(n,"/"),null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},t)},update:function(n,t,a){(0,o.send)("groups/".concat(n,"/"),JSON.stringify(t),{type:"PUT",contentType:"application/json;charset=utf-8",dataType:"text"},a)},create:function(n,t){(0,o.send)("groups/",JSON.stringify(n),{type:"POST",contentType:"application/json;charset=utf-8",dataType:"text"},t)},delete:function(n,t){(0,o.send)("groups/".concat(n,"/"),null,{type:"DELETE"},t)},listPermissions:function(n){(0,o.send)("permissions/",null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},n)},updateGroupPermissions:function(n,t){(0,o.send)("groups/update_groups_permissions/",JSON.stringify(n),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},t)}})}.apply(t,[]))||(n.exports=i)}).call(this,a(218))}}]);